# Here is the script Iâ€™ve used to create the Application Gateway:

# creating the resource group
az group create -n Adharsh -l WestUS2

#To create a virtual network (VNet) in Azure
az network vnet create \
    --name adharsh-VNet \
    --resource-group Adharsh \
    --location WestUS2 \
    --address-prefixes 10.0.0.0/16 \
    --subnet-name adharsh-Subnet \
    --subnet-prefix 10.0.0.0/24


#To create a new subnet in an existing virtual network (VNet)
az network vnet subnet create \
    --name adharsh-Subnet-2 \
    --vnet-name adharsh-VNet \
    --resource-group Adharsh \
    --address-prefixes 10.0.1.0/24

#To create an Azure Kubernetes Service (AKS) cluster
az aks create \
    --resource-group Adharsh \
    --name adharshAKSCluster \
    --node-count 1 \
    --node-vm-size Standard_DS2_v2 \
    --location WestUS2


# create public ip
az network public-ip create -n adharsh-pub-IP -g Adharsh --allocation-method Static --sku Standard
# create application gateway 
az network application-gateway create -n adharsh-app-gateway -l WestUS2 -g Adharsh --sku Standard_v2 --public-ip-address adharsh-pub-IP --subnet /subscriptions/27c2e3f9-b40e-4da9-95d8-ebfda85f9de6/resourceGroups/Adharsh/providers/Microsoft.Network/virtualNetworks/adharsh-VNet/Subnets/adharsh-Subnet-2


Then we enable the addon:

# enable AGIC on an existing AKS cluster
appgwId=$(az network application-gateway show -n <appgwname> -g <resourcegroupname> -o tsv --query "id") 
az aks enable-addons -n <aksclustername> -g <aksresourcegroupname> -a ingress-appgw --appgw-id $appgwId